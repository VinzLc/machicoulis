{"ast":null,"code":"'use strict';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HubInternal = exports.Hub = exports.HubClass = exports.AMPLIFY_SYMBOL = void 0;\nconst Logger_1 = require(\"../Logger\");\nconst constants_1 = require(\"../constants\");\nconst errors_1 = require(\"../errors\");\nexports.AMPLIFY_SYMBOL = typeof Symbol !== 'undefined' ? Symbol('amplify_default') : '@@amplify_default';\nconst logger = new Logger_1.ConsoleLogger('Hub');\nclass HubClass {\n  constructor(name) {\n    this.listeners = new Map();\n    this.protectedChannels = ['core', 'auth', 'api', 'analytics', 'interactions', 'pubsub', 'storage', 'ui', 'xr'];\n    this.name = name;\n  }\n  /**\n   * Used internally to remove a Hub listener.\n   *\n   * @remarks\n   * This private method is for internal use only. Instead of calling Hub.remove, call the result of Hub.listen.\n   */\n  _remove(channel, listener) {\n    const holder = this.listeners.get(channel);\n    if (!holder) {\n      logger.warn(`No listeners for ${channel}`);\n      return;\n    }\n    this.listeners.set(channel, [...holder.filter(({\n      callback\n    }) => callback !== listener)]);\n  }\n  dispatch(channel, payload, source, ampSymbol) {\n    if (typeof channel === 'string' && this.protectedChannels.indexOf(channel) > -1) {\n      const hasAccess = ampSymbol === exports.AMPLIFY_SYMBOL;\n      if (!hasAccess) {\n        logger.warn(`WARNING: ${channel} is protected and dispatching on it can have unintended consequences`);\n      }\n    }\n    const capsule = {\n      channel,\n      payload: {\n        ...payload\n      },\n      source,\n      patternInfo: []\n    };\n    try {\n      this._toListeners(capsule);\n    } catch (e) {\n      logger.error(e);\n    }\n  }\n  listen(channel, callback, listenerName = 'noname') {\n    let cb;\n    if (typeof callback !== 'function') {\n      throw new errors_1.AmplifyError({\n        name: constants_1.NO_HUBCALLBACK_PROVIDED_EXCEPTION,\n        message: 'No callback supplied to Hub'\n      });\n    } else {\n      // Needs to be casted as a more generic type\n      cb = callback;\n    }\n    let holder = this.listeners.get(channel);\n    if (!holder) {\n      holder = [];\n      this.listeners.set(channel, holder);\n    }\n    holder.push({\n      name: listenerName,\n      callback: cb\n    });\n    return () => {\n      this._remove(channel, cb);\n    };\n  }\n  _toListeners(capsule) {\n    const {\n      channel,\n      payload\n    } = capsule;\n    const holder = this.listeners.get(channel);\n    if (holder) {\n      holder.forEach(listener => {\n        logger.debug(`Dispatching to ${channel} with `, payload);\n        try {\n          listener.callback(capsule);\n        } catch (e) {\n          logger.error(e);\n        }\n      });\n    }\n  }\n}\nexports.HubClass = HubClass;\n/* We export a __default__ instance of HubClass to use it as a\npseudo Singleton for the main messaging bus, however you can still create\nyour own instance of HubClass() for a separate \"private bus\" of events. */\nexports.Hub = new HubClass('__default__');\n/**\n * @internal\n *\n * Internal hub used for core Amplify functionality. Not intended for use outside of Amplify.\n *\n */\nexports.HubInternal = new HubClass('internal-hub');","map":{"version":3,"names":["Object","defineProperty","exports","value","HubInternal","Hub","HubClass","AMPLIFY_SYMBOL","Logger_1","require","constants_1","errors_1","Symbol","logger","ConsoleLogger","constructor","name","listeners","Map","protectedChannels","_remove","channel","listener","holder","get","warn","set","filter","callback","dispatch","payload","source","ampSymbol","indexOf","hasAccess","capsule","patternInfo","_toListeners","e","error","listen","listenerName","cb","AmplifyError","NO_HUBCALLBACK_PROVIDED_EXCEPTION","message","push","forEach","debug"],"sources":["C:\\Users\\vinzl\\workspace\\machicoulis\\daily-image-collector\\node_modules\\@aws-amplify\\core\\src\\Hub\\index.ts"],"sourcesContent":["\"use strict\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HubInternal = exports.Hub = exports.HubClass = exports.AMPLIFY_SYMBOL = void 0;\nconst Logger_1 = require(\"../Logger\");\nconst constants_1 = require(\"../constants\");\nconst errors_1 = require(\"../errors\");\nexports.AMPLIFY_SYMBOL = (typeof Symbol !== 'undefined'\n    ? Symbol('amplify_default')\n    : '@@amplify_default');\nconst logger = new Logger_1.ConsoleLogger('Hub');\nclass HubClass {\n    constructor(name) {\n        this.listeners = new Map();\n        this.protectedChannels = [\n            'core',\n            'auth',\n            'api',\n            'analytics',\n            'interactions',\n            'pubsub',\n            'storage',\n            'ui',\n            'xr',\n        ];\n        this.name = name;\n    }\n    /**\n     * Used internally to remove a Hub listener.\n     *\n     * @remarks\n     * This private method is for internal use only. Instead of calling Hub.remove, call the result of Hub.listen.\n     */\n    _remove(channel, listener) {\n        const holder = this.listeners.get(channel);\n        if (!holder) {\n            logger.warn(`No listeners for ${channel}`);\n            return;\n        }\n        this.listeners.set(channel, [\n            ...holder.filter(({ callback }) => callback !== listener),\n        ]);\n    }\n    dispatch(channel, payload, source, ampSymbol) {\n        if (typeof channel === 'string' &&\n            this.protectedChannels.indexOf(channel) > -1) {\n            const hasAccess = ampSymbol === exports.AMPLIFY_SYMBOL;\n            if (!hasAccess) {\n                logger.warn(`WARNING: ${channel} is protected and dispatching on it can have unintended consequences`);\n            }\n        }\n        const capsule = {\n            channel,\n            payload: { ...payload },\n            source,\n            patternInfo: [],\n        };\n        try {\n            this._toListeners(capsule);\n        }\n        catch (e) {\n            logger.error(e);\n        }\n    }\n    listen(channel, callback, listenerName = 'noname') {\n        let cb;\n        if (typeof callback !== 'function') {\n            throw new errors_1.AmplifyError({\n                name: constants_1.NO_HUBCALLBACK_PROVIDED_EXCEPTION,\n                message: 'No callback supplied to Hub',\n            });\n        }\n        else {\n            // Needs to be casted as a more generic type\n            cb = callback;\n        }\n        let holder = this.listeners.get(channel);\n        if (!holder) {\n            holder = [];\n            this.listeners.set(channel, holder);\n        }\n        holder.push({\n            name: listenerName,\n            callback: cb,\n        });\n        return () => {\n            this._remove(channel, cb);\n        };\n    }\n    _toListeners(capsule) {\n        const { channel, payload } = capsule;\n        const holder = this.listeners.get(channel);\n        if (holder) {\n            holder.forEach(listener => {\n                logger.debug(`Dispatching to ${channel} with `, payload);\n                try {\n                    listener.callback(capsule);\n                }\n                catch (e) {\n                    logger.error(e);\n                }\n            });\n        }\n    }\n}\nexports.HubClass = HubClass;\n/* We export a __default__ instance of HubClass to use it as a\npseudo Singleton for the main messaging bus, however you can still create\nyour own instance of HubClass() for a separate \"private bus\" of events. */\nexports.Hub = new HubClass('__default__');\n/**\n * @internal\n *\n * Internal hub used for core Amplify functionality. Not intended for use outside of Amplify.\n *\n */\nexports.HubInternal = new HubClass('internal-hub');\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}