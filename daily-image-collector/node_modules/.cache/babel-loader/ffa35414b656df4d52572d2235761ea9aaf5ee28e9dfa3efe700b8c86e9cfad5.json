{"ast":null,"code":"import crc32 from 'crc-32';\nimport { hexToBase64 } from './hexUtils.mjs';\nimport { readFile } from './readFile.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst CHUNK_SIZE = 1024 * 1024; // 1MB chunks\n/**\n * Calculate the CRC32 checksum for given content and return base64 encoded checksum.\n */\nconst calculateContentCRC32 = async (content, seed = 0) => {\n  let internalSeed = seed;\n  if (content instanceof ArrayBuffer || ArrayBuffer.isView(content)) {\n    let uint8Array;\n    if (content instanceof ArrayBuffer) {\n      uint8Array = new Uint8Array(content);\n    } else {\n      uint8Array = new Uint8Array(content.buffer, content.byteOffset, content.byteLength);\n    }\n    let offset = 0;\n    while (offset < uint8Array.length) {\n      const end = Math.min(offset + CHUNK_SIZE, uint8Array.length);\n      const chunk = uint8Array.slice(offset, end);\n      internalSeed = crc32.buf(chunk, internalSeed) >>> 0;\n      offset = end;\n    }\n  } else {\n    let blob;\n    if (content instanceof Blob) {\n      blob = content;\n    } else {\n      blob = new Blob([content]);\n    }\n    let offset = 0;\n    while (offset < blob.size) {\n      const end = Math.min(offset + CHUNK_SIZE, blob.size);\n      const chunk = blob.slice(offset, end);\n      const arrayBuffer = await readFile(chunk);\n      const uint8Array = new Uint8Array(arrayBuffer);\n      internalSeed = crc32.buf(uint8Array, internalSeed) >>> 0;\n      offset = end;\n    }\n  }\n  const hex = internalSeed.toString(16).padStart(8, '0');\n  return hexToBase64(hex);\n};\nexport { calculateContentCRC32 };","map":{"version":3,"names":["CHUNK_SIZE","calculateContentCRC32","content","seed","internalSeed","ArrayBuffer","isView","uint8Array","Uint8Array","buffer","byteOffset","byteLength","offset","length","end","Math","min","chunk","slice","crc32","buf","blob","Blob","size","arrayBuffer","readFile","hex","toString","padStart","hexToBase64"],"sources":["C:\\Users\\vinzl\\workspace\\machicoulis\\daily-image-collector\\node_modules\\@aws-amplify\\storage\\src\\providers\\s3\\utils\\crc32.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport crc32 from 'crc-32';\nimport { hexToBase64 } from './hexUtils';\nimport { readFile } from './readFile';\nconst CHUNK_SIZE = 1024 * 1024; // 1MB chunks\n/**\n * Calculate the CRC32 checksum for given content and return base64 encoded checksum.\n */\nexport const calculateContentCRC32 = async (content, seed = 0) => {\n    let internalSeed = seed;\n    if (content instanceof ArrayBuffer || ArrayBuffer.isView(content)) {\n        let uint8Array;\n        if (content instanceof ArrayBuffer) {\n            uint8Array = new Uint8Array(content);\n        }\n        else {\n            uint8Array = new Uint8Array(content.buffer, content.byteOffset, content.byteLength);\n        }\n        let offset = 0;\n        while (offset < uint8Array.length) {\n            const end = Math.min(offset + CHUNK_SIZE, uint8Array.length);\n            const chunk = uint8Array.slice(offset, end);\n            internalSeed = crc32.buf(chunk, internalSeed) >>> 0;\n            offset = end;\n        }\n    }\n    else {\n        let blob;\n        if (content instanceof Blob) {\n            blob = content;\n        }\n        else {\n            blob = new Blob([content]);\n        }\n        let offset = 0;\n        while (offset < blob.size) {\n            const end = Math.min(offset + CHUNK_SIZE, blob.size);\n            const chunk = blob.slice(offset, end);\n            const arrayBuffer = await readFile(chunk);\n            const uint8Array = new Uint8Array(arrayBuffer);\n            internalSeed = crc32.buf(uint8Array, internalSeed) >>> 0;\n            offset = end;\n        }\n    }\n    const hex = internalSeed.toString(16).padStart(8, '0');\n    return hexToBase64(hex);\n};\n"],"mappings":";;;;AAAA;AACA;AAIA,MAAMA,UAAU,GAAG,IAAI,GAAG,IAAI,CAAC;AAC/B;AACA;AACA;AACY,MAACC,qBAAqB,GAAG,MAAAA,CAAOC,OAAO,EAAEC,IAAI,GAAG,CAAC,KAAK;EAC9D,IAAIC,YAAY,GAAGD,IAAI;EACvB,IAAID,OAAO,YAAYG,WAAW,IAAIA,WAAW,CAACC,MAAM,CAACJ,OAAO,CAAC,EAAE;IAC/D,IAAIK,UAAU;IACd,IAAIL,OAAO,YAAYG,WAAW,EAAE;MAChCE,UAAU,GAAG,IAAIC,UAAU,CAACN,OAAO,CAAC;IAChD,OACa;MACDK,UAAU,GAAG,IAAIC,UAAU,CAACN,OAAO,CAACO,MAAM,EAAEP,OAAO,CAACQ,UAAU,EAAER,OAAO,CAACS,UAAU,CAAC;IAC/F;IACQ,IAAIC,MAAM,GAAG,CAAC;IACd,OAAOA,MAAM,GAAGL,UAAU,CAACM,MAAM,EAAE;MAC/B,MAAMC,GAAG,GAAGC,IAAI,CAACC,GAAG,CAACJ,MAAM,GAAGZ,UAAU,EAAEO,UAAU,CAACM,MAAM,CAAC;MAC5D,MAAMI,KAAK,GAAGV,UAAU,CAACW,KAAK,CAACN,MAAM,EAAEE,GAAG,CAAC;MAC3CV,YAAY,GAAGe,KAAK,CAACC,GAAG,CAACH,KAAK,EAAEb,YAAY,CAAC,KAAK,CAAC;MACnDQ,MAAM,GAAGE,GAAG;IACxB;EACA,OACS;IACD,IAAIO,IAAI;IACR,IAAInB,OAAO,YAAYoB,IAAI,EAAE;MACzBD,IAAI,GAAGnB,OAAO;IAC1B,OACa;MACDmB,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACpB,OAAO,CAAC,CAAC;IACtC;IACQ,IAAIU,MAAM,GAAG,CAAC;IACd,OAAOA,MAAM,GAAGS,IAAI,CAACE,IAAI,EAAE;MACvB,MAAMT,GAAG,GAAGC,IAAI,CAACC,GAAG,CAACJ,MAAM,GAAGZ,UAAU,EAAEqB,IAAI,CAACE,IAAI,CAAC;MACpD,MAAMN,KAAK,GAAGI,IAAI,CAACH,KAAK,CAACN,MAAM,EAAEE,GAAG,CAAC;MACrC,MAAMU,WAAW,GAAG,MAAMC,QAAQ,CAACR,KAAK,CAAC;MACzC,MAAMV,UAAU,GAAG,IAAIC,UAAU,CAACgB,WAAW,CAAC;MAC9CpB,YAAY,GAAGe,KAAK,CAACC,GAAG,CAACb,UAAU,EAAEH,YAAY,CAAC,KAAK,CAAC;MACxDQ,MAAM,GAAGE,GAAG;IACxB;EACA;EACI,MAAMY,GAAG,GAAGtB,YAAY,CAACuB,QAAQ,CAAC,EAAE,CAAC,CAACC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;EACtD,OAAOC,WAAW,CAACH,GAAG,CAAC;AAC3B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}